<!DOCTYPE html>
<html lang="pt-br">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Teste de Tradu√ß√£o - BPO Innova</title>
    <style>
        body { font-family: Arial, sans-serif; margin: 20px; }
        .test-section { margin: 20px 0; padding: 20px; border: 1px solid #ddd; border-radius: 8px; }
        .language-buttons { margin: 20px 0; }
        .language-buttons button { margin: 5px; padding: 10px; cursor: pointer; }
    </style>
</head>
<body>
    <h1>Teste da Funcionalidade de Tradu√ß√£o</h1>

    <div class="language-buttons">
        <button onclick="event.preventDefault(); changeLanguage('pt'); return false;">üáßüá∑ Portugu√™s</button>
        <button onclick="event.preventDefault(); changeLanguage('en'); return false;">üá∫üá∏ Ingl√™s</button>
        <button onclick="event.preventDefault(); changeLanguage('es'); return false;">üá™üá∏ Espanhol</button>
        <button onclick="event.preventDefault(); changeLanguage('fr'); return false;">üá´üá∑ Franc√™s</button>
    </div>

    <div style="margin: 20px 0; padding: 10px; background: #f8f9fa; border: 1px solid #dee2e6; border-radius: 4px;">
        <strong>üí° Dica:</strong> Se o dropdown do header n√£o funcionar, um banner de tradu√ß√£o aparecer√° automaticamente como alternativa.
    </div>

    <div class="test-section">
        <h2>Texto de Teste em Portugu√™s</h2>
        <p>Este √© um texto de exemplo para testar a funcionalidade de tradu√ß√£o do Google Translate. Quando voc√™ clicar em um dos bot√µes acima, todo o conte√∫do desta p√°gina ser√° traduzido automaticamente para o idioma selecionado.</p>

        <p>A BPO Innova √© especializada em servi√ßos de terceiriza√ß√£o de processos de neg√≥cio, oferecendo solu√ß√µes personalizadas que impulsionam a efici√™ncia operacional e permitem que sua empresa foque no que realmente importa: crescimento e inova√ß√£o.</p>

        <h3>Nossos Servi√ßos</h3>
        <ul>
            <li>Contabilidade</li>
            <li>Servi√ßos Fiscais</li>
            <li>BPO Financeiro</li>
            <li>Folha de Pagamento</li>
            <li>Tecnologia e Inova√ß√£o</li>
            <li>Servi√ßos Paralegais</li>
            <li>Servi√ßos Especiais</li>
        </ul>
    </div>

    <!-- Google Translate Widget -->
    <div id="google_translate_element" style="display: none;"></div>

    <script type="text/javascript">
        var googleTranslateLoaded = false;
        var translateRetries = 0;
        var maxRetries = 10;

        function googleTranslateElementInit() {
            try {
                new google.translate.TranslateElement({
                    pageLanguage: 'pt',
                    includedLanguages: 'pt,en,es,fr,de,it,ja,ko,zh-CN,hi',
                    layout: google.translate.TranslateElement.InlineLayout.SIMPLE,
                    autoDisplay: false
                }, 'google_translate_element');
                googleTranslateLoaded = true;
                console.log('Google Translate carregado com sucesso!');
            } catch (error) {
                console.error('Erro ao inicializar Google Translate:', error);
                retryGoogleTranslate();
            }
        }

        function changeLanguage(lang) {
            console.log('Iniciando mudan√ßa de idioma para:', lang);

            if (!googleTranslateLoaded) {
                console.log('Google Translate ainda n√£o carregado, tentando novamente...');
                // Tentar carregar novamente se ainda n√£o carregou
                if (translateRetries < maxRetries) {
                    console.log('Tentando carregar Google Translate...');
                    retryGoogleTranslate();
                    setTimeout(function() {
                        changeLanguage(lang);
                    }, 2000);
                } else {
                    alert('Erro: Google Translate n√£o conseguiu carregar. Verifique sua conex√£o com a internet e tente novamente mais tarde.');
                }
                return;
            }

                  // Fun√ß√£o auxiliar para encontrar o select
            function findGoogleTranslateSelect() {
                console.log('üîç Procurando elemento select do Google Translate...');

                // Primeiro, verificar se existe algum elemento select em qualquer lugar
                var allSelects = document.querySelectorAll('select');
                console.log('üìä Total de elementos select encontrados:', allSelects.length);

                // Listar todos os selects encontrados
                allSelects.forEach(function(select, index) {
                    console.log('Select #' + (index + 1) + ':', select, 'Classes:', select.className, 'ID:', select.id);
                });

                // Verificar elementos relacionados ao Google Translate
                var googleElement = document.getElementById('google_translate_element');
                var skipTranslateElement = document.querySelector('.skiptranslate');

                console.log('üéØ Elemento google_translate_element:', googleElement);
                console.log('üéØ Elemento skiptranslate:', skipTranslateElement);

                if (skipTranslateElement) {
                    console.log('üéØ Conte√∫do do skiptranslate:', skipTranslateElement.innerHTML);
                    var selectInSkipTranslate = skipTranslateElement.querySelector('select');
                    if (selectInSkipTranslate) {
                        console.log('‚úÖ Select encontrado dentro de .skiptranslate!');
                        return selectInSkipTranslate;
                    }
                }

                // Tentar diferentes seletores
                var selectors = [
                    'select.goog-te-combo',
                    '.goog-te-combo',
                    'select[class*="goog-te-combo"]',
                    '#google_translate_element select',
                    '.skiptranslate select',
                    'select[name*="lang"]',
                    'select[onchange*="Translate"]',
                    '.goog-te-menu-value select'
                ];

                for (var i = 0; i < selectors.length; i++) {
                    var element = document.querySelector(selectors[i]);
                    if (element) {
                        console.log('‚úÖ Elemento encontrado com seletor:', selectors[i], element);
                        return element;
                    }
                }

                // Buscar recursivamente em todos os elementos filhos do skiptranslate
                if (skipTranslateElement) {
                    function findSelectRecursively(element) {
                        if (element.tagName === 'SELECT') {
                            console.log('‚úÖ Select encontrado recursivamente:', element);
                            return element;
                        }

                        for (var i = 0; i < element.children.length; i++) {
                            var result = findSelectRecursively(element.children[i]);
                            if (result) return result;
                        }

                        return null;
                    }

                    var recursiveResult = findSelectRecursively(skipTranslateElement);
                    if (recursiveResult) {
                        return recursiveResult;
                    }
                }

                // Buscar em todos os iframes tamb√©m
                var iframes = document.querySelectorAll('iframe');
                console.log('üîç Verificando', iframes.length, 'iframes...');

                for (var j = 0; j < iframes.length; j++) {
                    try {
                        console.log('Verificando iframe #' + (j + 1));
                        var iframeDoc = iframes[j].contentDocument || iframes[j].contentWindow.document;
                        if (iframeDoc) {
                            var selectInIframe = iframeDoc.querySelector('select');
                            if (selectInIframe) {
                                console.log('‚úÖ Elemento encontrado em iframe');
                                return selectInIframe;
                            }
                        }
                    } catch (e) {
                        console.log('‚ùå Erro ao acessar iframe #' + (j + 1) + ':', e.message);
                    }
                }

                console.log('‚ùå Nenhum elemento select encontrado');
                return null;
            }

            var selectField = findGoogleTranslateSelect();

            // Fun√ß√£o de debug global para console
            window.debugGoogleTranslate = function() {
                console.log('üîß === DEBUG GOOGLE TRANSLATE ===');
                console.log('üåê googleTranslateLoaded:', googleTranslateLoaded);
                console.log('üî¢ translateRetries:', translateRetries);

                var allSelects = document.querySelectorAll('select');
                console.log('üìä Total de selects na p√°gina:', allSelects.length);

                allSelects.forEach(function(select, index) {
                    console.log('Select #' + (index + 1) + ':', {
                        element: select,
                        classes: select.className,
                        id: select.id,
                        name: select.name,
                        value: select.value,
                        options: select.options ? select.options.length : 'N/A'
                    });
                });

                var skipTranslate = document.querySelector('.skiptranslate');
                console.log('üéØ .skiptranslate element:', skipTranslate);

                if (skipTranslate) {
                    console.log('üéØ Conte√∫do HTML de .skiptranslate:', skipTranslate.innerHTML);
                    console.log('üéØ Estrutura DOM de .skiptranslate:', skipTranslate);
                    console.log('üéØ Filhos do .skiptranslate:', skipTranslate.children.length);

                    // Mostrar todos os filhos
                    for (var i = 0; i < skipTranslate.children.length; i++) {
                        var child = skipTranslate.children[i];
                        console.log('  Filho #' + (i + 1) + ':', child, 'Tag:', child.tagName, 'Classes:', child.className);

                        // Se for um select, mostrar mais detalhes
                        if (child.tagName === 'SELECT') {
                            console.log('    üìã SELECT encontrado! Value:', child.value, 'Options:', child.options.length);
                        }
                    }
                }

                console.log('üîß === FIM DEBUG ===');
            };

            // Fun√ß√£o para for√ßar busca do select (√∫til para debug)
            window.forceFindGoogleTranslateSelect = function() {
                console.log('üîç For√ßando busca do elemento select...');

                var selectors = [
                    'select.goog-te-combo',
                    '.goog-te-combo',
                    'select[class*="goog-te-combo"]',
                    '#google_translate_element select',
                    '.skiptranslate select',
                    'select[name*="lang"]',
                    'select[onchange*="Translate"]',
                    '.goog-te-menu-value select'
                ];

                for (var i = 0; i < selectors.length; i++) {
                    var element = document.querySelector(selectors[i]);
                    if (element) {
                        console.log('‚úÖ ENCONTRADO com seletor:', selectors[i], element);
                        return element;
                    }
                }

                console.log('‚ùå Nenhum select encontrado com seletores padr√£o');

                // Busca mais profunda
                var skipTranslate = document.querySelector('.skiptranslate');
                if (skipTranslate) {
                    console.log('üîç Buscando recursivamente no .skiptranslate...');
                    function findSelectRecursively(element) {
                        if (element.tagName === 'SELECT') {
                            console.log('üéâ SELECT encontrado recursivamente:', element);
                            return element;
                        }
                        for (var i = 0; i < element.children.length; i++) {
                            var result = findSelectRecursively(element.children[i]);
                            if (result) return result;
                        }
                        return null;
                    }

                    var result = findSelectRecursively(skipTranslate);
                    if (result) {
                        return result;
                    }
                }

                console.log('‚ùå Nenhum select encontrado em lugar nenhum');
                return null;
            };

            // Fun√ß√£o para testar tradu√ß√£o manualmente
            window.testTranslation = function(lang) {
                console.log('üß™ Testando tradu√ß√£o manual para:', lang);

                var selectElement = forceFindGoogleTranslateSelect();

                if (selectElement) {
                    console.log('üéØ Alterando valor do select para:', lang);
                    selectElement.value = lang;
                    selectElement.dispatchEvent(new Event('change'));
                    console.log('‚úÖ Evento de mudan√ßa disparado!');
                    return true;
                } else {
                    console.log('‚ùå Select n√£o encontrado. Tente novamente em alguns segundos.');
                    return false;
                }
            };

            if (selectField) {
                console.log('Select encontrado, alterando valor para:', lang);
                selectField.value = lang;
                selectField.dispatchEvent(new Event('change'));
                console.log('Idioma alterado com sucesso para:', lang);
            } else {
                console.warn('Elemento select do Google Translate n√£o encontrado. Tentando novamente...');

                // Debug: mostrar todos os elementos relacionados ao Google Translate
                console.log('Debug - Elementos encontrados:');
                console.log('select.goog-te-combo:', document.querySelector('select.goog-te-combo'));
                console.log('.goog-te-combo:', document.querySelector('.goog-te-combo'));
                console.log('Todos os selects:', document.querySelectorAll('select'));
                console.log('Elemento google_translate_element:', document.getElementById('google_translate_element'));
                console.log('Classe skiptranslate:', document.querySelector('.skiptranslate'));

                // Sistema de retry m√∫ltiplo com delays progressivos
                var retryAttempts = 0;
                var maxRetryAttempts = 5;
                var retryDelays = [1000, 1500, 2000, 3000, 5000]; // Delays progressivos

                function attemptChangeLanguage() {
                    retryAttempts++;
                    console.log('üîÑ Tentativa', retryAttempts, 'de', maxRetryAttempts, 'de encontrar o select...');

                    var selectFieldRetry = findGoogleTranslateSelect();
                    if (selectFieldRetry) {
                        console.log('üéâ Select encontrado na tentativa', retryAttempts);
                        selectFieldRetry.value = lang;
                        selectFieldRetry.dispatchEvent(new Event('change'));
                        console.log('üåê Idioma alterado na tentativa', retryAttempts, 'para:', lang);
                    } else if (retryAttempts < maxRetryAttempts) {
                        // Aguardar o delay progressivo e tentar novamente
                        var delay = retryDelays[retryAttempts - 1] || 2000;
                        console.log('‚è≥ Aguardando', delay, 'ms antes da pr√≥xima tentativa...');
                        setTimeout(attemptChangeLanguage, delay);
                    } else {
                        console.error('‚ùå Select n√£o encontrado ap√≥s', maxRetryAttempts, 'tentativas');
                        alert('Erro: O sistema de tradu√ß√£o ainda n√£o est√° totalmente carregado. Aguarde alguns segundos e tente novamente. Se o problema persistir, recarregue a p√°gina.');
                    }
                }

                // Iniciar tentativas
                attemptChangeLanguage();
            }
        }

        function retryGoogleTranslate() {
            translateRetries++;
            console.log('Tentativa de carregamento #' + translateRetries);

            if (translateRetries >= maxRetries) {
                console.error('M√°ximo de tentativas atingido. Google Translate n√£o p√¥de ser carregado.');
                alert('Erro: N√£o foi poss√≠vel carregar o servi√ßo de tradu√ß√£o. Verifique sua conex√£o com a internet.');
                return;
            }

            // Remover script antigo se existir
            var oldScript = document.querySelector('script[src*="translate.google.com"]');
            if (oldScript) {
                oldScript.remove();
            }

            // Carregar novamente
            setTimeout(function() {
                var gt = document.createElement('script');
                gt.type = 'text/javascript';
                gt.async = true;
                gt.src = 'https://translate.google.com/translate_a/element.js?cb=googleTranslateElementInit';
                var s = document.getElementsByTagName('script')[0];
                s.parentNode.insertBefore(gt, s);
            }, 1000);
        }

        // Verificar se o Google Translate j√° est√° carregado a cada 500ms por 10 segundos
        var checkInterval = setInterval(function() {
            if (document.querySelector('select.goog-te-combo') && !googleTranslateLoaded) {
                googleTranslateLoaded = true;
                clearInterval(checkInterval);
                console.log('Google Translate detectado via polling!');
            }
        }, 500);

        // Limpar o interval ap√≥s 10 segundos
        setTimeout(function() {
            clearInterval(checkInterval);
        }, 10000);

        // Carregar Google Translate API
        (function(){
            var gt = document.createElement('script');
            gt.type = 'text/javascript';
            gt.async = true;
            gt.src = 'https://translate.google.com/translate_a/element.js?cb=googleTranslateElementInit';
            gt.onerror = function() {
                console.error('Erro ao carregar script do Google Translate');
                retryGoogleTranslate();
            };
            var s = document.getElementsByTagName('script')[0];
            s.parentNode.insertBefore(gt, s);
        })();
    </script>
</body>
</html>
